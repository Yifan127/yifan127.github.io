<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="impala," />










<meta name="description" content="Create database12CREATE database IF NOT EXISTS &amp;lt;database_name&amp;gt;;USE &amp;lt;database_name&amp;gt;; An impala database is created inside the Impala directory on HDFS with the name _database_name.db_.1234[">
<meta name="keywords" content="impala">
<meta property="og:type" content="article">
<meta property="og:title" content="Impala SQL Statement">
<meta property="og:url" content="http://yoursite.com/2018/07/14/Impala-SQL-Statement/index.html">
<meta property="og:site_name" content="Machine Learning and Data Science">
<meta property="og:description" content="Create database12CREATE database IF NOT EXISTS &amp;lt;database_name&amp;gt;;USE &amp;lt;database_name&amp;gt;; An impala database is created inside the Impala directory on HDFS with the name _database_name.db_.1234[">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2018-07-14T09:47:58.392Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Impala SQL Statement">
<meta name="twitter:description" content="Create database12CREATE database IF NOT EXISTS &amp;lt;database_name&amp;gt;;USE &amp;lt;database_name&amp;gt;; An impala database is created inside the Impala directory on HDFS with the name _database_name.db_.1234[">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/07/14/Impala-SQL-Statement/"/>





  <title>Impala SQL Statement | Machine Learning and Data Science</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Machine Learning and Data Science</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/14/Impala-SQL-Statement/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yifan Zhang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/author.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Machine Learning and Data Science">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Impala SQL Statement</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-07-14T17:43:57+12:00">
                2018-07-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Hadoop/" itemprop="url" rel="index">
                    <span itemprop="name">Hadoop</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="Create-database"><a href="#Create-database" class="headerlink" title="Create database"></a>Create database</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE database IF NOT EXISTS &lt;database_name&gt;;</span><br><span class="line">USE &lt;database_name&gt;;</span><br></pre></td></tr></table></figure>
<p>An impala database is created inside the Impala directory on HDFS with the name _database_name.db_.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[cloudera@quickstart ~]$ hadoop fs -ls /user/hive/warehouse</span><br><span class="line">Found 10 items</span><br><span class="line">drwxrwxrwx   - cloudera supergroup          0 2018-07-06 03:05 /user/hive/warehouse/categories</span><br><span class="line">drwxrwxrwx   - impala   supergroup          0 2018-07-14 01:57 /user/hive/warehouse/my_database.db</span><br></pre></td></tr></table></figure></p>
<h3 id="Create-table"><a href="#Create-table" class="headerlink" title="Create table"></a>Create table</h3><ul>
<li><p>Explicit column definitions </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE IF NOT EXISTS customer( </span><br><span class="line">customer_id	INT,	 </span><br><span class="line">customer_firstname STRING,	 </span><br><span class="line">customer_lastname STRING	 </span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Create table as select</p>
<p>  Clone the structure of a table and transfer data into it.</p>
<ul>
<li><p>clone a table</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE customer_clone AS SELECT * FROM customer;</span><br></pre></td></tr></table></figure>
</li>
<li><p>copy only some rows</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE customer_part AS SELECT * FROM customer WHERE customer_id&lt;=2;</span><br></pre></td></tr></table></figure>
</li>
<li><p>clone the table and convert to a different format</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE customer_parquet stored AS parquet AS SELECT * FROM customer;</span><br><span class="line">``` </span><br><span class="line">* Rename and reorder columns</span><br><span class="line">```commandline</span><br><span class="line">CREATE TABLE customer_new AS </span><br><span class="line">SELECT customer_id+1 AS id, UPPER(customer_lastname) AS lastname,</span><br><span class="line">UPPER(customer_firstname) AS firstname FROM customer;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Create table like</p>
<p>  Create an empty table with the same structure as another table.</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE customer_empty_clone LIKE customer;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Create external table<br>  The tables created are internal tables by default. They are managed by Impala. External table use arbitrary HDFS directories, where the data files are typically shared between different Hadoop components. Impala leaves the data files in place when you drop the table</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE EXTERNAL TABLE external_parquet (c1 INT, c2 STRING, c3 TIMESTAMP) </span><br><span class="line">STORED AS PARQUET LOCATION &apos;/user/tests&apos;;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li>Check the files in HDFS<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[cloudera@quickstart ~]$ hadoop fs -ls /user/hive/warehouse/my_database.db</span><br><span class="line">Found 6 items</span><br><span class="line">drwxrwxrwx   - impala supergroup          0 2018-07-14 00:37 /user/hive/warehouse/my_database.db/customer_clone</span><br><span class="line">drwxrwxrwx   - impala supergroup          0 2018-07-14 01:06 /user/hive/warehouse/my_database.db/customer_like</span><br><span class="line">drwxrwxrwx   - impala supergroup          0 2018-07-14 01:12 /user/hive/warehouse/my_database.db/customer_new</span><br><span class="line">drwxrwxrwx   - impala supergroup          0 2018-07-14 00:56 /user/hive/warehouse/my_database.db/customer_parquet</span><br><span class="line">drwxrwxrwx   - impala supergroup          0 2018-07-14 00:53 /user/hive/warehouse/my_database.db/customer_part</span><br><span class="line">drwxrwxrwx   - impala supergroup          0 2018-07-14 00:35 /user/hive/warehouse/my_database.db/customer</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Insert-rows"><a href="#Insert-rows" class="headerlink" title="Insert rows"></a>Insert rows</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO customer VALUES (1, &apos;Mary&apos;, &apos;Graze&apos;), (2, &apos;Yong&apos;, &apos;Que&apos;), (3, &apos;Sarah&apos;, &apos;Han&apos;);</span><br></pre></td></tr></table></figure>
<h3 id="Alter-table"><a href="#Alter-table" class="headerlink" title="Alter table"></a>Alter table</h3><ul>
<li><p>Add, drop, change columns</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE customer ADD COLUMNS (address STRING, age TINYINT, gender BOOLEAN);</span><br><span class="line">ALTER TABLE customer DROP COLUMN address;</span><br><span class="line">ALTER TABLE customer CHANGE age customer_age SMALLINT;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Rename a table</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE customer RENAME TO v1_customer;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>For internal tables, this operation physically renames the directory within HDFS that contains the data files; the original directory name no longer exists.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[cloudera@quickstart ~]$ hadoop fs -ls /user/hive/warehouse/my_database.db</span><br><span class="line">Found 6 items</span><br><span class="line">drwxrwxrwx   - impala supergroup          0 2018-07-14 00:37 /user/hive/warehouse/my_database.db/customer_clone</span><br><span class="line">drwxrwxrwx   - impala supergroup          0 2018-07-14 01:06 /user/hive/warehouse/my_database.db/customer_like</span><br><span class="line">drwxrwxrwx   - impala supergroup          0 2018-07-14 01:12 /user/hive/warehouse/my_database.db/customer_new</span><br><span class="line">drwxrwxrwx   - impala supergroup          0 2018-07-14 00:56 /user/hive/warehouse/my_database.db/customer_parquet</span><br><span class="line">drwxrwxrwx   - impala supergroup          0 2018-07-14 00:53 /user/hive/warehouse/my_database.db/customer_part</span><br><span class="line">drwxrwxrwx   - impala supergroup          0 2018-07-14 00:35 /user/hive/warehouse/my_database.db/v1_customer</span><br></pre></td></tr></table></figure></p>
<p>For external tables, to change the physical location where Impala looks for data files associated with a table:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE external_parquet SET LOCATION &apos;/user/test1&apos;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>Change file format<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE v1_customer SET FILEFORMAT PARQUET;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Load-data"><a href="#Load-data" class="headerlink" title="Load data"></a>Load data</h3><p>Load data from HDFS files into Impala tables. The loaded file <code>test.txt</code> is moved from HDFS to the Impala data directory.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE t1(s STRINT);</span><br><span class="line">LOAD DATA INPATH &apos;/user/hive/warehouse/test.txt&apos; INTO TABLE t1;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/impala/" rel="tag"># impala</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/07/14/Impala-Shell-Commands-General/" rel="next" title="Impala Shell Commands - General commands">
                <i class="fa fa-chevron-left"></i> Impala Shell Commands - General commands
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/author.gif"
                alt="Yifan Zhang" />
            
              <p class="site-author-name" itemprop="name">Yifan Zhang</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">21</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">24</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Create-database"><span class="nav-number">1.</span> <span class="nav-text">Create database</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Create-table"><span class="nav-number">2.</span> <span class="nav-text">Create table</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Insert-rows"><span class="nav-number">3.</span> <span class="nav-text">Insert rows</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Alter-table"><span class="nav-number">4.</span> <span class="nav-text">Alter table</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Load-data"><span class="nav-number">5.</span> <span class="nav-text">Load data</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yifan Zhang</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
